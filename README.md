# å­¦ä¹  Solidity å®Œæˆä¸€ä¸ª CryptoZombie æ¸¸æˆé¡¹ç›®

> æœ¬æ•™ç¨‹åªæ˜¯æŠŠ https://cryptozombies.io/zh ç½‘ç«™ä¸­çš„æ•™ç¨‹æ‘˜å½•ä¸‹æ¥ï¼Œç”¨äºå­¦ä¹ å›é¡¾ï¼Œå…·ä½“å®æ“è¯·åœ¨ç½‘ç«™ä¸Šå­¦ä¹ å®è·µï¼Œé…Œæƒ…å‚è€ƒã€‚



## 1. å¼€å§‹ä¸€ä¸ªä¸­çº§çš„æ™ºèƒ½åˆçº¦

ä½ è®¤ä¸ºä½ å¯ä»¥å½“ä¸€ä¸ªåˆæ ¼çš„ **CryptoZombie**, å—¯ï¼Ÿ

è¿™ä¸ªæ•™ç¨‹ä¼šæ•™ä½ å¦‚ä½•æ­å»ºä¸€ä¸ª**ä»¥å¤ªç½‘çš„æ¸¸æˆ**ã€‚

æ­¤è¯¾ç¨‹ä¸º Solidity åˆå­¦è€…è®¾è®¡ï¼Œéœ€è¦ä½ å¯¹å…¶ä»–çš„ç¨‹åºè¯­è¨€æœ‰æ‰€äº†è§£ï¼ˆå¦‚ JavaScript)ã€‚

### 1.1 æ­å»ºåƒµå°¸å·¥å‚

#### ç¬¬1ç«  æ¦‚è¿°

ç¬¬ä¸€è¯¾ä½ å°†åˆ›é€ ä¸€ä¸ª"åƒµå°¸å·¥å‚"ï¼Œ ç”¨å®ƒå»ºç«‹ä¸€æ”¯åƒµå°¸éƒ¨é˜Ÿã€‚

- æˆ‘ä»¬çš„å·¥å‚ä¼šæŠŠæˆ‘ä»¬éƒ¨é˜Ÿä¸­æ‰€æœ‰çš„åƒµå°¸ä¿å­˜åˆ°æ•°æ®åº“ä¸­
- å·¥å‚ä¼šæœ‰ä¸€ä¸ªå‡½æ•°èƒ½äº§ç”Ÿæ–°çš„åƒµå°¸
- æ¯ä¸ªåƒµå°¸ä¼šæœ‰ä¸€ä¸ªéšæœºçš„ç‹¬ä¸€æ— äºŒçš„é¢å­”

åœ¨åé¢çš„è¯¾ç¨‹é‡Œï¼Œæˆ‘ä»¬ä¼šå¢åŠ åŠŸèƒ½ã€‚æ¯”å¦‚ï¼Œè®©åƒµå°¸èƒ½æ”»å‡»äººç±»æˆ–å…¶å®ƒåƒµå°¸! ä½†æ˜¯åœ¨å®ç°è¿™äº›å¥½ç©çš„åŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦å®ç°åˆ›å»ºåƒµå°¸è¿™æ ·çš„åŸºæœ¬åŠŸèƒ½ã€‚

##### åƒµå°¸ DNA å¦‚ä½•è¿ä½œ

åƒµå°¸çš„é¢å­”å–å†³äºå®ƒçš„DNAã€‚å®ƒçš„DNAå¾ˆç®€å•ï¼Œç”±ä¸€ä¸ª16ä½çš„æ•´æ•°ç»„æˆï¼š

``` bash
8356281049284737
```

å¦‚åŒçœŸæ­£çš„DNA, è¿™ä¸ªæ•°å­—çš„ä¸åŒéƒ¨åˆ†ä¼šå¯¹åº”ä¸åŒçš„ç‰¹ç‚¹ã€‚ å‰2ä½ä»£è¡¨å¤´å‹ï¼Œç´§æ¥ç€çš„2ä½ä»£è¡¨çœ¼ç›ï¼Œç­‰ç­‰ã€‚

> *æ³¨: æœ¬æ•™ç¨‹æˆ‘ä»¬å°½é‡ç®€åŒ–ã€‚æˆ‘ä»¬çš„åƒµå°¸åªæœ‰7ç§å¤´å‹(è™½ç„¶2ä½æ•°å­—å…è®¸100ç§å¯èƒ½æ€§)ã€‚ä»¥åæˆ‘ä»¬ä¼šåŠ å…¥æ›´å¤šçš„å¤´å‹, å¦‚æœæˆ‘ä»¬æƒ³è®©åƒµå°¸æœ‰æ›´å¤šé€ å‹ã€‚*

ä¾‹å¦‚ï¼Œå‰ä¸¤ä½æ•°å­—æ˜¯ `83`ï¼Œ è®¡ç®—åƒµå°¸çš„å¤´å‹ï¼Œæˆ‘ä»¬åš`83 % 7 + 1` = 7 è¿ç®—ï¼Œ æ­¤åƒµå°¸å°†è¢«èµ‹äºˆç¬¬ä¸ƒç±»å¤´å‹ã€‚

åœ¨å³è¾¹é¡µé¢ï¼Œç§»åŠ¨å¤´åŸºå› `head gene` æ»‘å—åˆ°ç¬¬ä¸ƒä½ç½®(åœ£è¯å¸½)å¯è§`83`æ‰€å¯¹åº”çš„ç‰¹ç‚¹ã€‚

##### å®æˆ˜æ¼”ä¹ 

1. ç©ä¸€ä¸‹é¡µé¢å³ä¾§çš„æ»‘å—ã€‚æ£€éªŒä¸€ä¸‹ä¸åŒçš„æ•°å­—å¯¹åº”ä¸åŒçš„åƒµå°¸çš„é•¿ç›¸ã€‚

å¥½äº†ï¼Œè¿™å·²ç»è¶³å¤Ÿä½ ç©ä¸€ä¼šå„¿äº†ã€‚ å½“ä½ æƒ³ç»§ç»­çš„æ—¶å€™ï¼Œç‚¹å‡»ä¸‹é¢çš„"ä¸‹ä¸€ç« "ï¼Œè®©æˆ‘ä»¬æ¥é’»ç ” Solidity ï¼

<img src="https://markdown-res.oss-cn-hangzhou.aliyuncs.com/mdImgs/2022/04/28/20220428104132.png" align="center" style="width:500px" />



#### ç¬¬2ç«  åˆçº¦

ä»æœ€åŸºæœ¬çš„å¼€å§‹å…¥æ‰‹:

Solidity çš„ä»£ç éƒ½åŒ…è£¹åœ¨**åˆçº¦**é‡Œé¢. ä¸€ä»½`åˆçº¦`å°±æ˜¯ä»¥å¤ªåº”å¸åº”ç”¨çš„åŸºæœ¬æ¨¡å—ï¼Œ æ‰€æœ‰çš„å˜é‡å’Œå‡½æ•°éƒ½å±äºä¸€ä»½åˆçº¦, å®ƒæ˜¯ä½ æ‰€æœ‰åº”ç”¨çš„èµ·ç‚¹.

ä¸€ä»½åä¸º `HelloWorld` çš„ç©ºåˆçº¦å¦‚ä¸‹:

``` solidity
contract HelloWorld {

}
```

##### ç‰ˆæœ¬æŒ‡ä»¤

æ‰€æœ‰çš„ Solidity æºç éƒ½å¿…é¡»å† ä»¥ "version pragma" â€” æ ‡æ˜ Solidity ç¼–è¯‘å™¨çš„ç‰ˆæœ¬. ä»¥é¿å…å°†æ¥æ–°çš„ç¼–è¯‘å™¨å¯èƒ½ç ´åä½ çš„ä»£ç ã€‚

ä¾‹å¦‚: `pragma solidity ^0.4.19;` (å½“å‰ Solidity çš„æœ€æ–°ç‰ˆæœ¬æ˜¯ 0.4.19).

ç»¼ä¸Šæ‰€è¿°ï¼Œ ä¸‹é¢å°±æ˜¯ä¸€ä¸ªæœ€åŸºæœ¬çš„åˆçº¦ â€” æ¯æ¬¡å»ºç«‹ä¸€ä¸ªæ–°çš„é¡¹ç›®æ—¶çš„ç¬¬ä¸€æ®µä»£ç :

``` solidity
pragma solidity ^0.4.19;

contract HelloWorld {

}
```

##### å®æˆ˜æ¼”ä¹ 

ä¸ºäº†å»ºç«‹æˆ‘ä»¬çš„åƒµå°¸éƒ¨é˜Ÿï¼Œ è®©æˆ‘ä»¬å…ˆå»ºç«‹ä¸€ä¸ªåŸºç¡€åˆçº¦ï¼Œç§°ä¸º `ZombieFactory`ã€‚

1. åœ¨å³è¾¹çš„è¾“å…¥æ¡†é‡Œè¾“å…¥ `0.4.19`ï¼Œæˆ‘ä»¬çš„åˆçº¦åŸºäºè¿™ä¸ªç‰ˆæœ¬çš„ç¼–è¯‘å™¨ã€‚
2. å»ºç«‹ä¸€ä¸ªç©ºåˆçº¦ `ZombieFactory`ã€‚

ä¸€åˆ‡å®Œæ¯•ï¼Œä¸‹é¢ "ç­”æ¡ˆ" ï¼š

``` solidity
pragma solidity ^0.4.19; //1. è¿™é‡Œå†™ç‰ˆæœ¬æŒ‡ä»¤

//2. è¿™é‡Œå»ºç«‹æ™ºèƒ½åˆçº¦
contract ZombieFactory {
}
```



#### ç¬¬3ç«  çŠ¶æ€å˜é‡å’Œæ•´æ•°

çœŸæ£’ï¼æˆ‘ä»¬å·²ç»ä¸ºæˆ‘ä»¬çš„åˆçº¦åšäº†ä¸€ä¸ªå¤–å£³ï¼Œ ä¸‹é¢å­¦ä¹  Solidity ä¸­å¦‚ä½•ä½¿ç”¨å˜é‡ã€‚

##### çŠ¶æ€å˜é‡

***çŠ¶æ€å˜é‡*** æ˜¯è¢«æ°¸ä¹…åœ°ä¿å­˜åœ¨åˆçº¦ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´å®ƒä»¬è¢«å†™å…¥ä»¥å¤ªå¸åŒºå—é“¾ä¸­. æƒ³è±¡æˆå†™å…¥ä¸€ä¸ªæ•°æ®åº“ã€‚

ä¾‹å­ï¼š

``` solidity
contract Example {
  // è¿™ä¸ªæ— ç¬¦å·æ•´æ•°å°†ä¼šæ°¸ä¹…çš„è¢«ä¿å­˜åœ¨åŒºå—é“¾ä¸­
  uint myUnsignedInteger = 100;
}
```

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå®šä¹‰ `myUnsignedInteger` ä¸º `uint` ç±»å‹ï¼Œå¹¶èµ‹å€¼100ã€‚

##### æ— ç¬¦å·æ•´æ•° uint

`uint` æ— ç¬¦å·æ•°æ®ç±»å‹ï¼Œ æŒ‡**å…¶å€¼ä¸èƒ½æ˜¯è´Ÿæ•°**ï¼Œå¯¹äºæœ‰ç¬¦å·çš„æ•´æ•°å­˜åœ¨åä¸º `int` çš„æ•°æ®ç±»å‹ã€‚

> *æ³¨: Solidityä¸­ï¼Œ* `uint` *å®é™…ä¸Šæ˜¯* `uint256`*ä»£åè¯ï¼Œ ä¸€ä¸ª256ä½çš„æ— ç¬¦å·æ•´æ•°ã€‚ä½ ä¹Ÿå¯ä»¥å®šä¹‰ä½æ•°å°‘çš„uints â€”* `uint8`*ï¼Œ* `uint16`*ï¼Œ* `uint32`*ï¼Œ ç­‰â€¦â€¦ ä½†ä¸€èˆ¬æ¥è®²ä½ æ„¿æ„ä½¿ç”¨ç®€å•çš„* `uint`*ï¼Œ é™¤éåœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œè¿™æˆ‘ä»¬åé¢ä¼šè®²ã€‚*

##### å®æˆ˜æ¼”ä¹ 

æˆ‘ä»¬çš„åƒµå°¸DNAå°†ç”±ä¸€ä¸ªåå…­ä½æ•°å­—ç»„æˆã€‚

å®šä¹‰ `dnaDigits` ä¸º `uint` æ•°æ®ç±»å‹, å¹¶èµ‹å€¼ `16`ã€‚

``` solidity
pragma solidity ^0.4.19;

contract ZombieFactory {
    uint dnaDigits = 16;
}
```



#### ç¬¬4ç«  æ•°å­¦è¿ç®—

åœ¨ Solidity ä¸­ï¼Œæ•°å­¦è¿ç®—å¾ˆç›´è§‚æ˜äº†ï¼Œä¸å…¶å®ƒç¨‹åºè®¾è®¡è¯­è¨€ç›¸åŒ:

- åŠ æ³•: `x + y`
- å‡æ³•: `x - y`,
- ä¹˜æ³•: `x * y`
- é™¤æ³•: `x / y`
- å–æ¨¡ / æ±‚ä½™: `x % y` *(ä¾‹å¦‚, `13 % 5` ä½™ `3`, å› ä¸º13é™¤ä»¥5ï¼Œä½™3)*

Solidity è¿˜æ”¯æŒ ***ä¹˜æ–¹æ“ä½œ\*** (å¦‚ï¼šx çš„ yæ¬¡æ–¹ï¼‰ // ä¾‹å¦‚ï¼š 5 ** 2 = 25

```solidity
uint x = 5 ** 2; // equal to 5^2 = 25
```

##### å®æˆ˜æ¼”ä¹ 

ä¸ºäº†ä¿è¯æˆ‘ä»¬çš„åƒµå°¸çš„DNAåªå«æœ‰16ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬å…ˆé€ ä¸€ä¸ª`uint`æ•°æ®ï¼Œè®©å®ƒç­‰äº10^16ã€‚è¿™æ ·ä¸€æ¥ä»¥åæˆ‘ä»¬å¯ä»¥ç”¨æ¨¡è¿ç®—ç¬¦ `%` æŠŠä¸€ä¸ªæ•´æ•°å˜æˆ16ä½ã€‚

1. å»ºç«‹ä¸€ä¸ª`uint`ç±»å‹çš„å˜é‡ï¼Œåå­—å«`dnaModulus`, ä»¤å…¶ç­‰äº **10 çš„ `dnaDigits` æ¬¡æ–¹**.

``` solidity
pragma solidity ^0.4.19;

contract ZombieFactory {
    uint dnaDigits = 16;
    uint dnaModulus = 10 ** dnaDigits;
}
```



#### ç¬¬5ç«  ç»“æ„ä½“

æœ‰æ—¶ä½ éœ€è¦æ›´å¤æ‚çš„æ•°æ®ç±»å‹ï¼ŒSolidity æä¾›äº† **ç»“æ„ä½“**:

```solidity
struct Person {
  uint age;
  string name;
}
```

ç»“æ„ä½“å…è®¸ä½ ç”Ÿæˆä¸€ä¸ªæ›´å¤æ‚çš„æ•°æ®ç±»å‹ï¼Œå®ƒæœ‰å¤šä¸ªå±æ€§ã€‚

> æ³¨ï¼šæˆ‘ä»¬åˆšåˆšå¼•è¿›äº†ä¸€ä¸ªæ–°ç±»å‹, `string`ã€‚ å­—ç¬¦ä¸²ç”¨äºä¿å­˜ä»»æ„é•¿åº¦çš„ UTF-8 ç¼–ç æ•°æ®ã€‚ å¦‚ï¼š `string greeting = "Hello world!"`ã€‚

##### å®æˆ˜æ¼”ä¹ 

åœ¨æˆ‘ä»¬çš„ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€äº›åƒµå°¸ï¼æ¯ä¸ªåƒµå°¸å°†æ‹¥æœ‰å¤šä¸ªå±æ€§ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå±•ç¤ºç»“æ„ä½“çš„å®Œç¾ä¾‹å­ã€‚

1. å»ºç«‹ä¸€ä¸ª`struct` å‘½åä¸º `Zombie`.
2. æˆ‘ä»¬çš„ `Zombie` ç»“æ„ä½“æœ‰ä¸¤ä¸ªå±æ€§ï¼š `name` (ç±»å‹ä¸º `string`), å’Œ `dna` (ç±»å‹ä¸º `uint`)ã€‚

``` solidity
pragma solidity ^0.4.19;

contract ZombieFactory {
    uint dnaDigits = 16;
    uint dnaModulus = 10 ** dnaDigits;

    struct Zombie {
        string name;
        uint dna;
    }
}
```



#### ç¬¬6ç«  æ•°ç»„

å¦‚æœä½ æƒ³å»ºç«‹ä¸€ä¸ªé›†åˆï¼Œå¯ä»¥ç”¨ **_æ•°ç»„_**è¿™æ ·çš„æ•°æ®ç±»å‹. Solidity æ”¯æŒä¸¤ç§æ•°ç»„: **_é™æ€_** æ•°ç»„å’Œ**_åŠ¨æ€_** æ•°ç»„:

```solidity
// å›ºå®šé•¿åº¦ä¸º2çš„é™æ€æ•°ç»„:
uint[2] fixedArray;
// å›ºå®šé•¿åº¦ä¸º5çš„stringç±»å‹çš„é™æ€æ•°ç»„:
string[5] stringArray;
// åŠ¨æ€æ•°ç»„ï¼Œé•¿åº¦ä¸å›ºå®šï¼Œå¯ä»¥åŠ¨æ€æ·»åŠ å…ƒç´ :
uint[] dynamicArray;
```

ä½ ä¹Ÿå¯ä»¥å»ºç«‹ä¸€ä¸ª ***ç»“æ„ä½“*** ç±»å‹çš„æ•°ç»„ ä¾‹å¦‚ï¼Œä¸Šä¸€ç« æåˆ°çš„ `Person`:

```solidity
Person[] people; // è¿™æ˜¯åŠ¨æ€æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ä¸æ–­æ·»åŠ å…ƒç´ 
```

è®°ä½ï¼šçŠ¶æ€å˜é‡è¢«æ°¸ä¹…ä¿å­˜åœ¨åŒºå—é“¾ä¸­ã€‚æ‰€ä»¥åœ¨ä½ çš„åˆçº¦ä¸­åˆ›å»ºåŠ¨æ€æ•°ç»„æ¥ä¿å­˜æˆç»“æ„çš„æ•°æ®æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚

##### å…¬å…±æ•°ç»„

ä½ å¯ä»¥å®šä¹‰ `public` æ•°ç»„, Solidity ä¼šè‡ªåŠ¨åˆ›å»º ***getter*** æ–¹æ³•. è¯­æ³•å¦‚ä¸‹:

```solidity
Person[] public people;
```

å…¶å®ƒçš„åˆçº¦å¯ä»¥ä»è¿™ä¸ªæ•°ç»„è¯»å–æ•°æ®ï¼ˆä½†ä¸èƒ½å†™å…¥æ•°æ®ï¼‰ï¼Œæ‰€ä»¥è¿™åœ¨åˆçº¦ä¸­æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ä¿å­˜å…¬å…±æ•°æ®çš„æ¨¡å¼ã€‚

##### å®æˆ˜æ¼”ä¹ 

ä¸ºäº†æŠŠä¸€ä¸ªåƒµå°¸éƒ¨é˜Ÿä¿å­˜åœ¨æˆ‘ä»¬çš„APPé‡Œï¼Œå¹¶ä¸”èƒ½å¤Ÿè®©å…¶å®ƒAPPçœ‹åˆ°è¿™äº›åƒµå°¸ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå…¬å…±æ•°ç»„ã€‚

1. åˆ›å»ºä¸€ä¸ªæ•°æ®ç±»å‹ä¸º `Zombie` çš„ç»“æ„ä½“æ•°ç»„ï¼Œç”¨ `public` ä¿®é¥°ï¼Œå‘½åä¸ºï¼š`zombies`.

``` solidity
pragma solidity ^0.4.19;

contract ZombieFactory {
    uint dnaDigits = 16;
    uint dnaModulus = 10 ** dnaDigits;

    struct Zombie {
        string name;
        uint dna;
    }

    Zombie[] public zombies;
}
```



#### ç¬¬7ç«  å®šä¹‰å‡½æ•°

åœ¨ Solidity ä¸­å‡½æ•°å®šä¹‰çš„å¥æ³•å¦‚ä¸‹:

```solidity
function eatHamburgers(string _name, uint _amount) {
}
```

è¿™æ˜¯ä¸€ä¸ªåä¸º `eatHamburgers` çš„å‡½æ•°ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ª `string`ç±»å‹çš„ å’Œ ä¸€ä¸ª `uint`ç±»å‹çš„ã€‚ç°åœ¨å‡½æ•°å†…éƒ¨è¿˜æ˜¯ç©ºçš„ã€‚

> æ³¨ï¼š: ä¹ æƒ¯ä¸Šå‡½æ•°é‡Œçš„å˜é‡éƒ½æ˜¯ä»¥(`_`)å¼€å¤´ (ä½†ä¸æ˜¯ç¡¬æ€§è§„å®š) ä»¥åŒºåˆ«å…¨å±€å˜é‡ã€‚æˆ‘ä»¬æ•´ä¸ªæ•™ç¨‹éƒ½ä¼šæ²¿ç”¨è¿™ä¸ªä¹ æƒ¯ã€‚

æˆ‘ä»¬çš„å‡½æ•°å®šä¹‰å¦‚ä¸‹:

```solidity
eatHamburgers("vitalik", 100);
```

##### å®æˆ˜æ¼”ä¹ 

åœ¨æˆ‘ä»¬çš„åº”ç”¨é‡Œï¼Œæˆ‘ä»¬è¦èƒ½åˆ›å»ºä¸€äº›åƒµå°¸ï¼Œè®©æˆ‘ä»¬å†™ä¸€ä¸ªå‡½æ•°åšè¿™ä»¶äº‹å§ï¼

1. å»ºç«‹ä¸€ä¸ªå‡½æ•° `createZombie`ã€‚ å®ƒæœ‰ä¸¤ä¸ªå‚æ•°: **_name** (ç±»å‹ä¸º`string`), å’Œ **_dna** (ç±»å‹ä¸º`uint`)ã€‚

æš‚æ—¶è®©å‡½æ•°ç©ºç€â€”â€”æˆ‘ä»¬åœ¨åé¢ä¼šå¢åŠ å†…å®¹ã€‚

``` solidity
// SPDX-License-Identifier: MIT
pragma solidity >= 0.4.19;

contract ZombieFactory {
    uint dnaDigits = 16;
    uint dnaModulus = 10 ** dnaDigits;

    struct Zombie {
        string name;
        uint dna;
    }

    Zombie[] public zombies;

    function createZombie(string calldata _name, uint _dna) public {
    }
}
```



#### ç¬¬8ç«  ä½¿ç”¨ç»“æ„ä½“å’Œæ•°ç»„

##### åˆ›å»ºæ–°çš„ç»“æ„ä½“

è¿˜è®°å¾—ä¸Šä¸ªä¾‹å­ä¸­çš„ `Person` ç»“æ„å—ï¼Ÿ

```solidity
struct Person {
  uint age;
  string name;
}

Person[] public people;
```

ç°åœ¨æˆ‘ä»¬å­¦ä¹ åˆ›å»ºæ–°çš„ `Person` ç»“æ„ï¼Œç„¶åæŠŠå®ƒåŠ å…¥åˆ°åä¸º `people` çš„æ•°ç»„ä¸­.

```solidity
// åˆ›å»ºä¸€ä¸ªæ–°çš„Person:
Person satoshi = Person(172, "Satoshi");

// å°†æ–°åˆ›å»ºçš„satoshiæ·»åŠ è¿›peopleæ•°ç»„:
people.push(satoshi);
```

ä½ ä¹Ÿå¯ä»¥ä¸¤æ­¥å¹¶ä¸€æ­¥ï¼Œç”¨ä¸€è¡Œä»£ç æ›´ç®€æ´:

```solidity
people.push(Person(16, "Vitalik"));
```

> æ³¨ï¼š`array.push()` åœ¨æ•°ç»„çš„ **å°¾éƒ¨** åŠ å…¥æ–°å…ƒç´  ï¼Œæ‰€ä»¥å…ƒç´ åœ¨æ•°ç»„ä¸­çš„é¡ºåºå°±æ˜¯æˆ‘ä»¬æ·»åŠ çš„é¡ºåºï¼Œ å¦‚:

```solidity
uint[] numbers;
numbers.push(5);
numbers.push(10);
numbers.push(15);
// numbers is now equal to [5, 10, 15]
```

##### å®æˆ˜æ¼”ä¹ 

è®©æˆ‘ä»¬åˆ›å»ºåä¸ºcreateZombieçš„å‡½æ•°æ¥åšç‚¹å„¿ä»€ä¹ˆå§ã€‚

1. åœ¨å‡½æ•°ä½“é‡Œæ–°åˆ›å»ºä¸€ä¸ª `Zombie`ï¼Œ ç„¶åæŠŠå®ƒåŠ å…¥ `zombies` æ•°ç»„ä¸­ã€‚ æ–°åˆ›å»ºçš„åƒµå°¸çš„ `name` å’Œ `dna`ï¼Œæ¥è‡ªäºå‡½æ•°çš„å‚æ•°ã€‚
2. è®©æˆ‘ä»¬ç”¨ä¸€è¡Œä»£ç ç®€æ´åœ°å®Œæˆå®ƒã€‚

``` solidity
// SPDX-License-Identifier: MIT
pragma solidity >= 0.4.19;

contract ZombieFactory {

    uint dnaDigits = 16;
    uint dnaModulus = 10 ** dnaDigits;

    struct Zombie {
        string name;
        uint dna;
    }

    Zombie[] public zombies;

    function createZombie(string calldata _name, uint _dna) public {
        zombies.push(Zombie(_name, _dna));
    }
}
```



#### ç¬¬9ç«  ç§æœ‰ / å…¬å…±å‡½æ•°

Solidity å®šä¹‰çš„å‡½æ•°çš„å±æ€§é»˜è®¤ä¸º`å…¬å…±`ã€‚ è¿™å°±æ„å‘³ç€ä»»ä½•ä¸€æ–¹ (æˆ–å…¶å®ƒåˆçº¦) éƒ½å¯ä»¥è°ƒç”¨ä½ åˆçº¦é‡Œçš„å‡½æ•°ã€‚

æ˜¾ç„¶ï¼Œä¸æ˜¯ä»€ä¹ˆæ—¶å€™éƒ½éœ€è¦è¿™æ ·ï¼Œè€Œä¸”è¿™æ ·çš„åˆçº¦æ˜“äºå—åˆ°æ”»å‡»ã€‚ æ‰€ä»¥å°†è‡ªå·±çš„å‡½æ•°å®šä¹‰ä¸º`ç§æœ‰`æ˜¯ä¸€ä¸ªå¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œåªæœ‰å½“ä½ éœ€è¦å¤–éƒ¨ä¸–ç•Œè°ƒç”¨å®ƒæ—¶æ‰å°†å®ƒè®¾ç½®ä¸º`å…¬å…±`ã€‚

å¦‚ä½•å®šä¹‰ä¸€ä¸ªç§æœ‰çš„å‡½æ•°å‘¢ï¼Ÿ

```solidity
uint[] numbers;

function _addToArray(uint _number) private {
  numbers.push(_number);
}
```

è¿™æ„å‘³ç€åªæœ‰æˆ‘ä»¬åˆçº¦ä¸­çš„å…¶å®ƒå‡½æ•°æ‰èƒ½å¤Ÿè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œç»™ `numbers` æ•°ç»„æ·»åŠ æ–°æˆå‘˜ã€‚

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å‡½æ•°åå­—åé¢ä½¿ç”¨å…³é”®å­— `private` å³å¯ã€‚å’Œå‡½æ•°çš„å‚æ•°ç±»ä¼¼ï¼Œç§æœ‰å‡½æ•°çš„åå­—ç”¨(`_`)èµ·å§‹ã€‚

##### å®æˆ˜æ¼”ä¹ 

æˆ‘ä»¬åˆçº¦çš„å‡½æ•° `createZombie` çš„é»˜è®¤å±æ€§æ˜¯å…¬å…±çš„ï¼Œè¿™æ„å‘³ç€ä»»ä½•ä¸€æ–¹éƒ½å¯ä»¥è°ƒç”¨å®ƒå»åˆ›å»ºä¸€ä¸ªåƒµå°¸ã€‚ å’±ä»¬æ¥æŠŠå®ƒå˜æˆç§æœ‰å§ï¼

1. å˜ `createZombie` ä¸ºç§æœ‰å‡½æ•°ï¼Œä¸è¦å¿˜è®°éµå®ˆå‘½åçš„è§„çŸ©å“¦ï¼

``` solidity
// SPDX-License-Identifier: MIT
pragma solidity >= 0.4.19;

contract ZombieFactory {

    uint dnaDigits = 16;
    uint dnaModulus = 10 ** dnaDigits;

    struct Zombie {
        string name;
        uint dna;
    }

    Zombie[] public zombies;

    function _createZombie(string calldata _name, uint _dna) private {
        zombies.push(Zombie(_name, _dna));
    }
}
```



#### ç¬¬10ç«  å‡½æ•°çš„æ›´å¤šå±æ€§

æœ¬ç« ä¸­æˆ‘ä»¬å°†å­¦ä¹ å‡½æ•°çš„è¿”å›å€¼å’Œä¿®é¥°ç¬¦ã€‚

##### è¿”å›å€¼

è¦æƒ³å‡½æ•°è¿”å›ä¸€ä¸ªæ•°å€¼ï¼ŒæŒ‰å¦‚ä¸‹å®šä¹‰ï¼š

```solidity
string greeting = "What's up dog";

function sayHello() public returns (string) {
  return greeting;
}
```

Solidity é‡Œï¼Œå‡½æ•°çš„å®šä¹‰é‡Œå¯åŒ…å«è¿”å›å€¼çš„æ•°æ®ç±»å‹(å¦‚æœ¬ä¾‹ä¸­ `string`)ã€‚

##### å‡½æ•°çš„ä¿®é¥°ç¬¦

ä¸Šé¢çš„å‡½æ•°å®é™…ä¸Šæ²¡æœ‰æ”¹å˜ Solidity é‡Œçš„çŠ¶æ€ï¼Œå³ï¼Œå®ƒæ²¡æœ‰æ”¹å˜ä»»ä½•å€¼æˆ–è€…å†™ä»»ä½•ä¸œè¥¿ã€‚

è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥æŠŠå‡½æ•°å®šä¹‰ä¸º ***view***, æ„å‘³ç€å®ƒåªèƒ½è¯»å–æ•°æ®ä¸èƒ½æ›´æ”¹æ•°æ®:

```solidity
function sayHello() public view returns (string) {
```

Solidity è¿˜æ”¯æŒ ***pure*** å‡½æ•°, è¡¨æ˜è¿™ä¸ªå‡½æ•°ç”šè‡³éƒ½ä¸è®¿é—®åº”ç”¨é‡Œçš„æ•°æ®ï¼Œä¾‹å¦‚ï¼š

```solidity
function _multiply(uint a, uint b) private pure returns (uint) {
  return a * b;
}
```

è¿™ä¸ªå‡½æ•°ç”šè‡³éƒ½ä¸è¯»å–åº”ç”¨é‡Œçš„çŠ¶æ€ â€” å®ƒçš„è¿”å›å€¼å®Œå…¨å–å†³äºå®ƒçš„è¾“å…¥å‚æ•°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬æŠŠå‡½æ•°å®šä¹‰ä¸º ***pure***.

> æ³¨ï¼šå¯èƒ½å¾ˆéš¾è®°ä½ä½•æ—¶æŠŠå‡½æ•°æ ‡è®°ä¸º pure/viewã€‚ å¹¸è¿çš„æ˜¯ï¼Œ Solidity ç¼–è¾‘å™¨ä¼šç»™å‡ºæç¤ºï¼Œæé†’ä½ ä½¿ç”¨è¿™äº›ä¿®é¥°ç¬¦ã€‚

##### å®æˆ˜æ¼”ä¹ 

æˆ‘ä»¬æƒ³å»ºç«‹ä¸€ä¸ªå¸®åŠ©å‡½æ•°ï¼Œå®ƒæ ¹æ®ä¸€ä¸ªå­—ç¬¦ä¸²éšæœºç”Ÿæˆä¸€ä¸ªDNAæ•°æ®ã€‚

1. åˆ›å»ºä¸€ä¸ª `private` å‡½æ•°ï¼Œå‘½åä¸º `_generateRandomDna`ã€‚å®ƒåªæ¥æ”¶ä¸€ä¸ªè¾“å…¥å˜é‡ `_str` (ç±»å‹ `string`), è¿”å›ä¸€ä¸ª `uint` ç±»å‹çš„æ•°å€¼ã€‚
2. æ­¤å‡½æ•°åªè¯»å–æˆ‘ä»¬åˆçº¦ä¸­çš„ä¸€äº›å˜é‡ï¼Œæ‰€ä»¥æ ‡è®°ä¸º`view`ã€‚
3. å‡½æ•°å†…éƒ¨æš‚æ—¶ç•™ç©ºï¼Œä»¥åæˆ‘ä»¬å†æ·»åŠ ä»£ç ã€‚

``` solidity
// SPDX-License-Identifier: MIT
pragma solidity >=0.4.19;

contract ZombieFactory {
    uint dnaDigits = 16;
    uint dnaModulus = 10 ** dnaDigits;

    struct Zombie {
        string name;
        uint dna;
    }

    Zombie[] public zombies;

    function _createZombie(string calldata _name, uint _dna) private {
        zombies.push(Zombie(_name, _dna));
    }

    function _generateRandomDna(string calldata _str) private view returns (uint) {

    }
}
```



#### ç¬¬11ç«  Keccak256 å’Œ ç±»å‹è½¬æ¢

å¦‚ä½•è®© `_generateRandomDna` å‡½æ•°è¿”å›ä¸€ä¸ªå…¨(åŠ) éšæœºçš„ `uint`?

Ethereum å†…éƒ¨æœ‰ä¸€ä¸ªæ•£åˆ—å‡½æ•°`keccak256`ï¼Œå®ƒç”¨äº†SHA3ç‰ˆæœ¬ã€‚ä¸€ä¸ªæ•£åˆ—å‡½æ•°åŸºæœ¬ä¸Šå°±æ˜¯æŠŠä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ª256ä½çš„16è¿›åˆ¶æ•°å­—ã€‚å­—ç¬¦ä¸²çš„ä¸€ä¸ªå¾®å°å˜åŒ–ä¼šå¼•èµ·æ•£åˆ—æ•°æ®æå¤§å˜åŒ–ã€‚

è¿™åœ¨ Ethereum ä¸­æœ‰å¾ˆå¤šåº”ç”¨ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬åªæ˜¯ç”¨å®ƒé€ ä¸€ä¸ªä¼ªéšæœºæ•°ã€‚

ä¾‹å­:

```bash
//6e91ec6b618bb462a4a6ee5aa2cb0e9cf30f7a052bb467b0ba58b8748c00d2e5
keccak256("aaaab");
//b1f078126895a1424524de5321b339ab00408010b7cf0e6ed451514981e58aa9
keccak256("aaaac");
```

æ˜¾è€Œæ˜“è§ï¼Œè¾“å…¥å­—ç¬¦ä¸²åªæ”¹å˜äº†ä¸€ä¸ªå­—æ¯ï¼Œè¾“å‡ºå°±å·²ç»å¤©å£¤ä¹‹åˆ«äº†ã€‚

> æ³¨: åœ¨åŒºå—é“¾ä¸­**å®‰å…¨åœ°**äº§ç”Ÿä¸€ä¸ªéšæœºæ•°æ˜¯ä¸€ä¸ªå¾ˆéš¾çš„é—®é¢˜ï¼Œ æœ¬ä¾‹çš„æ–¹æ³•ä¸å®‰å…¨ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬çš„Zombie DNAç®—æ³•é‡Œä¸æ˜¯é‚£ä¹ˆé‡è¦ï¼Œå·²ç»å¾ˆå¥½åœ°æ»¡è¶³æˆ‘ä»¬çš„éœ€è¦äº†ã€‚

##### ç±»å‹è½¬æ¢

æœ‰æ—¶ä½ éœ€è¦å˜æ¢æ•°æ®ç±»å‹ã€‚ä¾‹å¦‚:

```solidity
uint8 a = 5;
uint b = 6;
// å°†ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå› ä¸º a * b è¿”å› uint, è€Œä¸æ˜¯ uint8:
uint8 c = a * b;
// æˆ‘ä»¬éœ€è¦å°† b è½¬æ¢ä¸º uint8:
uint8 c = a * uint8(b);
```

ä¸Šé¢, `a * b` è¿”å›ç±»å‹æ˜¯ `uint`, ä½†æ˜¯å½“æˆ‘ä»¬å°è¯•ç”¨ `uint8` ç±»å‹æ¥æ”¶æ—¶, å°±ä¼šé€ æˆæ½œåœ¨çš„é”™è¯¯ã€‚å¦‚æœæŠŠå®ƒçš„æ•°æ®ç±»å‹è½¬æ¢ä¸º `uint8`, å°±å¯ä»¥äº†ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ä¼šå‡ºé”™ã€‚

##### å®æˆ˜æ¼”ä¹ 

ç»™ `_generateRandomDna` å‡½æ•°æ·»åŠ ä»£ç ! å®ƒåº”è¯¥å®Œæˆå¦‚ä¸‹åŠŸèƒ½:

1. ç¬¬ä¸€è¡Œä»£ç å– `_str` çš„ `keccak256` æ•£åˆ—å€¼ç”Ÿæˆä¸€ä¸ªä¼ªéšæœºåå…­è¿›åˆ¶æ•°ï¼Œç±»å‹è½¬æ¢ä¸º `uint`, æœ€åä¿å­˜åœ¨ç±»å‹ä¸º `uint` åä¸º `rand` çš„å˜é‡ä¸­ã€‚
2. æˆ‘ä»¬åªæƒ³è®©æˆ‘ä»¬çš„DNAçš„é•¿åº¦ä¸º16ä½ (è¿˜è®°å¾— `dnaModulus`?)ã€‚æ‰€ä»¥ç¬¬äºŒè¡Œä»£ç åº”è¯¥ `return` ä¸Šé¢è®¡ç®—çš„æ•°å€¼å¯¹ `dnaModulus` æ±‚ä½™æ•°(`%`)ã€‚

``` solidity
// SPDX-License-Identifier: MIT
pragma solidity >= 0.4.19;

contract ZombieFactory {
    uint dnaDigits = 16;
    uint dnaModulus = 10 ** dnaDigits;

    struct Zombie {
        string name;
        uint dna;
    }

    Zombie[] public zombies;

    function _createZombie(string calldata _name, uint _dna) private {
        zombies.push(Zombie(_name, _dna));
    }

    function _generateRandomDna(string calldata _str) private view returns (uint) {
        uint rand = uint(keccak256(abi.encode(_str)));
        return rand % dnaModulus;
    }
}
```



#### ç¬¬12ç«  æ”¾åœ¨ä¸€èµ·

æˆ‘ä»¬å°±å¿«å®Œæˆæˆ‘ä»¬çš„éšæœºåƒµå°¸åˆ¶é€ å™¨äº†ï¼Œæ¥å†™ä¸€ä¸ªå…¬å…±çš„å‡½æ•°æŠŠæ‰€æœ‰çš„éƒ¨ä»¶è¿æ¥èµ·æ¥ã€‚

å†™ä¸€ä¸ªå…¬å…±å‡½æ•°ï¼Œå®ƒæœ‰ä¸€ä¸ªå‚æ•°ï¼Œç”¨æ¥æ¥æ”¶åƒµå°¸çš„åå­—ï¼Œä¹‹åç”¨å®ƒç”Ÿæˆåƒµå°¸çš„DNAã€‚

##### å®æˆ˜æ¼”ä¹ 

1. åˆ›å»ºä¸€ä¸ª `public` å‡½æ•°ï¼Œå‘½åä¸º `createRandomZombie`. å®ƒå°†è¢«ä¼ å…¥ä¸€ä¸ªå˜é‡ `_name` (æ•°æ®ç±»å‹æ˜¯ `string`)ã€‚ *(æ³¨: å®šä¹‰å…¬å…±å‡½æ•° `public` å’Œå®šä¹‰ä¸€ä¸ªç§æœ‰ `private` å‡½æ•°çš„åšæ³•ä¸€æ ·)*ã€‚
2. å‡½æ•°çš„ç¬¬ä¸€è¡Œåº”è¯¥è°ƒç”¨ `_generateRandomDna` å‡½æ•°ï¼Œä¼ å…¥ `_name` å‚æ•°, ç»“æœä¿å­˜åœ¨ä¸€ä¸ªç±»å‹ä¸º `uint` çš„å˜é‡é‡Œï¼Œå‘½åä¸º `randDna`ã€‚
3. ç¬¬äºŒè¡Œè°ƒç”¨ `_createZombie` å‡½æ•°ï¼Œ ä¼ å…¥å‚æ•°ï¼š `_name` å’Œ `randDna`ã€‚
4. æ•´ä¸ªå‡½æ•°åº”è¯¥æ˜¯4è¡Œä»£ç  (åŒ…æ‹¬å‡½æ•°çš„ç»“æŸç¬¦å· `}` )ã€‚

``` solidity
// SPDX-License-Identifier: MIT
pragma solidity >= 0.4.19;

contract ZombieFactory {
    uint dnaDigits = 16;
    uint dnaModulus = 10 ** dnaDigits;

    struct Zombie {
        string name;
        uint dna;
    }

    Zombie[] public zombies;

    function _createZombie(string calldata _name, uint _dna) private {
        zombies.push(Zombie(_name, _dna));
    }

    function _generateRandomDna(string calldata _str) private view returns (uint) {
        uint rand = uint(keccak256(abi.encode(_str)));
        return rand % dnaModulus;
    }

    function createRandomZombie(string calldata _name) public {
        uint randDna = _generateRandomDna(_name);
        _createZombie(_name, randDna);
    }
}
```



#### ç¬¬13ç«  äº‹ä»¶

æˆ‘ä»¬çš„åˆçº¦å‡ ä¹å°±è¦å®Œæˆäº†ï¼è®©æˆ‘ä»¬åŠ ä¸Šä¸€ä¸ª**äº‹ä»¶**.

**äº‹ä»¶** æ˜¯åˆçº¦å’ŒåŒºå—é“¾é€šè®¯çš„ä¸€ç§æœºåˆ¶ã€‚ä½ çš„å‰ç«¯åº”ç”¨â€œç›‘å¬â€æŸäº›äº‹ä»¶ï¼Œå¹¶åšå‡ºååº”ã€‚

ä¾‹å­:

```solidity
// è¿™é‡Œå»ºç«‹äº‹ä»¶
event IntegersAdded(uint x, uint y, uint result);

function add(uint _x, uint _y) public {
  uint result = _x + _y;
  //è§¦å‘äº‹ä»¶ï¼Œé€šçŸ¥app
  IntegersAdded(_x, _y, result);
  return result;
}
```

ä½ çš„ app å‰ç«¯å¯ä»¥ç›‘å¬è¿™ä¸ªäº‹ä»¶ã€‚JavaScript å®ç°å¦‚ä¸‹:

```solidity
YourContract.IntegersAdded(function(error, result) {
  // å¹²äº›äº‹
})
```

##### å®æˆ˜æ¼”ä¹ 

æˆ‘ä»¬æƒ³æ¯å½“ä¸€ä¸ªåƒµå°¸åˆ›é€ å‡ºæ¥æ—¶ï¼Œæˆ‘ä»¬çš„å‰ç«¯éƒ½èƒ½ç›‘å¬åˆ°è¿™ä¸ªäº‹ä»¶ï¼Œå¹¶å°†å®ƒæ˜¾ç¤ºå‡ºæ¥ã€‚

1. å®šä¹‰ä¸€ä¸ª `äº‹ä»¶` å«åš `NewZombie`ã€‚ å®ƒæœ‰3ä¸ªå‚æ•°: `zombieId` (`uint`)ï¼Œ `name` (`string`)ï¼Œ å’Œ `dna` (`uint`)ã€‚

2. ä¿®æ”¹ `_createZombie` å‡½æ•°ä½¿å¾—å½“æ–°åƒµå°¸é€ å‡ºæ¥å¹¶åŠ å…¥ `zombies`æ•°ç»„åï¼Œç”Ÿæˆäº‹ä»¶`NewZombie`ã€‚

3. éœ€è¦å®šä¹‰åƒµå°¸`id`ã€‚ `array.push()` è¿”å›æ•°ç»„çš„é•¿åº¦ç±»å‹æ˜¯`uint` - å› ä¸ºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•æ˜¯ 0ï¼Œ `array.push() - 1` å°†æ˜¯æˆ‘ä»¬åŠ å…¥çš„åƒµå°¸çš„ç´¢å¼•ã€‚ `zombies.push() - 1` å°±æ˜¯ `id`ï¼Œæ•°æ®ç±»å‹æ˜¯ `uint`ã€‚åœ¨ä¸‹ä¸€è¡Œä¸­ä½ å¯ä»¥æŠŠå®ƒç”¨åˆ° `NewZombie` äº‹ä»¶ä¸­ã€‚

``` solidity
// SPDX-License-Identifier: MIT
pragma solidity >= 0.4.19;

contract ZombieFactory {

    // è¿™é‡Œå»ºç«‹äº‹ä»¶
    event NewZombie(uint zombieId, string name, uint dna);
    uint dnaDigits = 16;
    uint dnaModulus = 10 ** dnaDigits;

    struct Zombie {
        string name;
        uint dna;
    }

    Zombie[] public zombies;

    function _createZombie(string memory _name, uint _dna) private {
        zombies.push(Zombie(_name, _dna));
        // è¿™é‡Œè§¦å‘äº‹ä»¶
        uint id = zombies.length -1;
        emit NewZombie(id, _name, _dna);
    }

    function _generateRandomDna(string memory _str) private view returns (uint) {
        uint rand = uint(keccak256(abi.encode(_str)));
        return rand % dnaModulus;
    }

    function createRandomZombie(string memory _name) public {
        uint randDna = _generateRandomDna(_name);
        _createZombie(_name, randDna);
    }
}
```



#### ç¬¬14ç«  Web3.js

æˆ‘ä»¬çš„ Solidity åˆçº¦å®Œå·¥äº†ï¼ ç°åœ¨æˆ‘ä»¬è¦å†™ä¸€æ®µ JavaScript å‰ç«¯ä»£ç æ¥è°ƒç”¨è¿™ä¸ªåˆçº¦ã€‚

ä»¥å¤ªåŠæœ‰ä¸€ä¸ª JavaScript åº“ï¼Œåä¸º ***Web3.js***ã€‚

åœ¨åé¢çš„è¯¾ç¨‹é‡Œï¼Œæˆ‘ä»¬ä¼šè¿›ä¸€æ­¥åœ°æ•™ä½ å¦‚ä½•å®‰è£…ä¸€ä¸ªåˆçº¦ï¼Œå¦‚ä½•è®¾ç½®Web3.jsã€‚ ä½†æ˜¯ç°åœ¨æˆ‘ä»¬é€šè¿‡ä¸€æ®µä»£ç æ¥äº†è§£ Web3.js æ˜¯å¦‚ä½•å’Œæˆ‘ä»¬å‘å¸ƒçš„åˆçº¦äº¤äº’çš„å§ã€‚

å¦‚æœä¸‹é¢çš„ä»£ç ä½ ä¸èƒ½å…¨éƒ½ç†è§£ï¼Œä¸ç”¨æ‹…å¿ƒã€‚

```javascript
// ä¸‹é¢æ˜¯è°ƒç”¨åˆçº¦çš„æ–¹å¼:
var abi = /* abiæ˜¯ç”±ç¼–è¯‘å™¨ç”Ÿæˆçš„ */
var ZombieFactoryContract = web3.eth.contract(abi)
var contractAddress = /* å‘å¸ƒä¹‹ååœ¨ä»¥å¤ªåŠä¸Šç”Ÿæˆçš„åˆçº¦åœ°å€ */
var ZombieFactory = ZombieFactoryContract.at(contractAddress)
// `ZombieFactory` èƒ½è®¿é—®å…¬å…±çš„å‡½æ•°ä»¥åŠäº‹ä»¶

// æŸä¸ªç›‘å¬æ–‡æœ¬è¾“å…¥çš„ç›‘å¬å™¨:
$("#ourButton").click(function(e) {
  var name = $("#nameInput").val()
  //è°ƒç”¨åˆçº¦çš„ `createRandomZombie` å‡½æ•°:
  ZombieFactory.createRandomZombie(name)
})

// ç›‘å¬ `NewZombie` äº‹ä»¶, å¹¶ä¸”æ›´æ–°UI
var event = ZombieFactory.NewZombie(function(error, result) {
  if (error) return
  generateZombie(result.zombieId, result.name, result.dna)
})

// è·å– Zombie çš„ dna, æ›´æ–°å›¾åƒ
function generateZombie(id, name, dna) {
  let dnaStr = String(dna)
  // å¦‚æœdnaå°‘äº16ä½,åœ¨å®ƒå‰é¢ç”¨0è¡¥ä¸Š
  while (dnaStr.length < 16)
    dnaStr = "0" + dnaStr

  let zombieDetails = {
    // å‰ä¸¤ä½æ•°æ„æˆå¤´éƒ¨.æˆ‘ä»¬å¯èƒ½æœ‰7ç§å¤´éƒ¨, æ‰€ä»¥ % 7
    // å¾—åˆ°çš„æ•°åœ¨0-6,å†åŠ ä¸Š1,æ•°çš„èŒƒå›´å˜æˆ1-7
    // é€šè¿‡è¿™æ ·è®¡ç®—ï¼š
    headChoice: dnaStr.substring(0, 2) % 7 + 1ï¼Œ
    // æˆ‘ä»¬å¾—åˆ°çš„å›¾ç‰‡åç§°ä»head1.png åˆ° head7.png

    // æ¥ä¸‹æ¥çš„ä¸¤ä½æ•°æ„æˆçœ¼ç›, çœ¼ç›å˜åŒ–å°±å¯¹11å–æ¨¡:
    eyeChoice: dnaStr.substring(2, 4) % 11 + 1,
    // å†æ¥ä¸‹æ¥çš„ä¸¤ä½æ•°æ„æˆè¡£æœï¼Œè¡£æœå˜åŒ–å°±å¯¹6å–æ¨¡:
    shirtChoice: dnaStr.substring(4, 6) % 6 + 1,
    //æœ€å6ä½æ§åˆ¶é¢œè‰². ç”¨cssé€‰æ‹©å™¨: hue-rotateæ¥æ›´æ–°
    // 360åº¦:
    skinColorChoice: parseInt(dnaStr.substring(6, 8) / 100 * 360),
    eyeColorChoice: parseInt(dnaStr.substring(8, 10) / 100 * 360),
    clothesColorChoice: parseInt(dnaStr.substring(10, 12) / 100 * 360),
    zombieName: name,
    zombieDescription: "A Level 1 CryptoZombie",
  }
  return zombieDetails
}
```

æˆ‘ä»¬çš„ JavaScript æ‰€åšçš„å°±æ˜¯è·å–ç”±`zombieDetails` äº§ç”Ÿçš„æ•°æ®, å¹¶ä¸”åˆ©ç”¨æµè§ˆå™¨é‡Œçš„ JavaScript ç¥å¥‡åŠŸèƒ½ (æˆ‘ä»¬ç”¨ Vue.js)ï¼Œç½®æ¢å‡ºå›¾åƒä»¥åŠä½¿ç”¨CSSè¿‡æ»¤å™¨ã€‚åœ¨åé¢çš„è¯¾ç¨‹ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°å…¨éƒ¨çš„ä»£ç ã€‚

##### è¯•ä¸€ä¸‹å§!

åœ¨å³é¢çš„è¾“å…¥æ¡†é‡Œè¾“å…¥ä½ çš„åå­—ï¼Œçœ‹çœ‹ä½ èƒ½å¾—åˆ°å“ªç§åƒµå°¸ï¼

**ä¸€æ—¦ä½ å¾—åˆ°ä¸€ä¸ªæ»¡æ„çš„åƒµå°¸, ç‚¹å‡»ä¸‹é¢çš„ "ä¸‹ä¸€ç« " æŒ‰é’®ä¿å­˜ä½ çš„åƒµå°¸ï¼Œç»“æŸç¬¬ä¸€è¯¾!**

<img src="https://markdown-res.oss-cn-hangzhou.aliyuncs.com/mdImgs/2022/04/28/20220428145457.png" align="center" style="width:500px" />

##### å¤ªæ£’å•¦ï¼ä½ å®Œæˆäº† CryptoZombies çš„ç¬¬ä¸€ä¸ªè¯¾ç¨‹!

ä½ ç¦»è‡ªå·±ç¼–è¯‘åŒºå—é“¾æ¸¸æˆè·¨å‡ºäº†å¾ˆå¤§çš„ä¸€æ­¥ã€‚

##### è·Ÿä½ çš„æœ‹å‹ä»¬æ™’ä¸€æ™’ä½ æ–°çš„åƒµå°¸å§ï¼

è¿™æ˜¯ä½ çš„åƒµå°¸çš„æ°¸ä¹…åœ°å€:

https://share.cryptozombies.io/zh/lesson/1/share/GG?id=Y3p8MjEwMTY2

[åŠ å…¥æˆ‘ä»¬çš„Telegram](https://t.me/loomnetworkdev)



### 1.2 åƒµå°¸æ”»å‡»äººç±»

#### ç¬¬1ç«  ç¬¬äºŒè¯¾æ¦‚è§ˆ

åœ¨ç¬¬ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå‡½æ•°ç”¨æ¥ç”Ÿæˆåƒµå°¸ï¼Œå¹¶ä¸”å°†å®ƒæ”¾å…¥åŒºå—é“¾ä¸Šçš„åƒµå°¸æ•°æ®åº“ä¸­ã€‚ åœ¨ç¬¬äºŒè¯¾é‡Œï¼Œæˆ‘ä»¬ä¼šè®©æˆ‘ä»¬çš„ app çœ‹èµ·æ¥æ›´åƒä¸€ä¸ªæ¸¸æˆï¼š å®ƒå¾—æ”¯æŒå¤šç”¨æˆ·ï¼Œå¹¶ä¸”é‡‡ç”¨æ›´åŠ æœ‰è¶£,è€Œä¸ä»…ä»…ä½¿ç”¨éšæœºçš„æ–¹å¼ï¼Œæ¥ç”Ÿæˆæ–°çš„åƒµå°¸ã€‚

å¦‚ä½•ç”Ÿæˆæ–°çš„åƒµå°¸å‘¢ï¼Ÿé€šè¿‡è®©ç°æœ‰çš„åƒµå°¸çŒé£Ÿå…¶ä»–ç”Ÿç‰©ï¼

##### åƒµå°¸çŒé£Ÿ

åƒµå°¸çŒé£Ÿçš„æ—¶å€™ï¼Œåƒµå°¸ç—…æ¯’ä¾µå…¥çŒç‰©ï¼Œè¿™äº›ç—…æ¯’ä¼šå°†çŒç‰©å˜ä¸ºæ–°çš„åƒµå°¸ï¼ŒåŠ å…¥ä½ çš„åƒµå°¸å¤§å†›ã€‚ç³»ç»Ÿä¼šé€šè¿‡çŒç‰©å’ŒçŒé£Ÿè€…åƒµå°¸çš„DNAè®¡ç®—å‡ºæ–°åƒµå°¸çš„DNAã€‚

åƒµå°¸æœ€å–œæ¬¢çŒé£Ÿä»€ä¹ˆç‰©ç§å‘¢ï¼Ÿ ç­‰ä½ å­¦å®Œç¬¬äºŒè¯¾å°±çŸ¥é“äº†ï¼

##### å®æˆ˜æ¼”ä¹ 

å³è¾¹æ˜¯ä¸€ä¸ªç®€å•çš„çŒé£Ÿæ¼”ç¤ºã€‚ç‚¹å‡»ä¸€ä¸ªâ€œäººâ€ï¼Œçœ‹çœ‹åƒµå°¸çŒé£Ÿçš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆ? å¯è§ï¼Œæ–°åƒµå°¸çš„DNAæ˜¯é€šè¿‡ä»åŸæ¥çš„åƒµå°¸çš„DNA, åŠ ä¸ŠçŒç‰©çš„DNAè®¡ç®—å¾—æ¥çš„ã€‚

å­¦å®Œè¿™ä¸€ç« ï¼Œè¯·ç‚¹å‡»â€œä¸‹ä¸€ç« â€ï¼Œ æˆ‘ä»¬è¯¥è®©æ¸¸æˆæ”¯æŒå¤šç©å®¶æ¨¡å¼äº†ã€‚

<img src="https://markdown-res.oss-cn-hangzhou.aliyuncs.com/mdImgs/2022/04/28/20220428161055.png" align="center" style="width:500px" />

<img src="https://markdown-res.oss-cn-hangzhou.aliyuncs.com/mdImgs/2022/04/28/20220428150659.png" align="center" style="width:500px" />



#### ç¬¬2ç«  æ˜ å°„ï¼ˆMappingï¼‰å’Œåœ°å€ï¼ˆAddressï¼‰

æˆ‘ä»¬é€šè¿‡ç»™æ•°æ®åº“ä¸­çš„åƒµå°¸æŒ‡å®šâ€œä¸»äººâ€ï¼Œ æ¥æ”¯æŒâ€œå¤šç©å®¶â€æ¨¡å¼ã€‚

å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥2ä¸ªæ–°çš„æ•°æ®ç±»å‹ï¼š`mapping`ï¼ˆæ˜ å°„ï¼‰ å’Œ `address`ï¼ˆåœ°å€ï¼‰ã€‚

##### Addresses ï¼ˆåœ°å€ï¼‰

ä»¥å¤ªåŠåŒºå—é“¾ç”± **_ account _** (è´¦æˆ·)ç»„æˆï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆé“¶è¡Œè´¦æˆ·ã€‚ä¸€ä¸ªå¸æˆ·çš„ä½™é¢æ˜¯ **_ä»¥å¤ª_** ï¼ˆåœ¨ä»¥å¤ªåŠåŒºå—é“¾ä¸Šä½¿ç”¨çš„å¸ç§ï¼‰ï¼Œä½ å¯ä»¥å’Œå…¶ä»–å¸æˆ·ä¹‹é—´æ”¯ä»˜å’Œæ¥å—ä»¥å¤ªå¸ï¼Œå°±åƒä½ çš„é“¶è¡Œå¸æˆ·å¯ä»¥ç”µæ±‡èµ„é‡‘åˆ°å…¶ä»–é“¶è¡Œå¸æˆ·ä¸€æ ·ã€‚

æ¯ä¸ªå¸æˆ·éƒ½æœ‰ä¸€ä¸ªâ€œåœ°å€â€ï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆé“¶è¡Œè´¦å·ã€‚è¿™æ˜¯è´¦æˆ·å”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œå®ƒçœ‹èµ·æ¥é•¿è¿™æ ·ï¼š

```bash
0x0cE446255506E92DF41614C46F1d6df9Cc969183
```

ï¼ˆè¿™æ˜¯ CryptoZombies å›¢é˜Ÿçš„åœ°å€ï¼Œå¦‚æœä½ å–œæ¬¢ CryptoZombies çš„è¯ï¼Œè¯·æ‰“èµæˆ‘ä»¬ä¸€äº›ä»¥å¤ªå¸ï¼ğŸ˜‰ï¼‰

æˆ‘ä»¬å°†åœ¨åé¢çš„è¯¾ç¨‹ä¸­ä»‹ç»åœ°å€çš„ç»†èŠ‚ï¼Œç°åœ¨ä½ åªéœ€è¦äº†è§£**åœ°å€å±äºç‰¹å®šç”¨æˆ·ï¼ˆæˆ–æ™ºèƒ½åˆçº¦ï¼‰çš„**ã€‚

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŒ‡å®šâ€œåœ°å€â€ä½œä¸ºåƒµå°¸ä¸»äººçš„ IDã€‚å½“ç”¨æˆ·é€šè¿‡ä¸æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºäº¤äº’æ¥åˆ›å»ºæ–°çš„åƒµå°¸æ—¶ï¼Œæ–°åƒµå°¸çš„æ‰€æœ‰æƒè¢«è®¾ç½®åˆ°è°ƒç”¨è€…çš„ä»¥å¤ªåŠåœ°å€ä¸‹ã€‚

##### Mappingï¼ˆæ˜ å°„ï¼‰

åœ¨ç¬¬1è¯¾ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº† **_ ç»“æ„ä½“ _** å’Œ **_ æ•°ç»„ _** ã€‚ **_æ˜ å°„_** æ˜¯å¦ä¸€ç§åœ¨ Solidity ä¸­å­˜å‚¨æœ‰ç»„ç»‡æ•°æ®çš„æ–¹æ³•ã€‚

æ˜ å°„æ˜¯è¿™æ ·å®šä¹‰çš„ï¼š

```solidity
//å¯¹äºé‡‘èåº”ç”¨ç¨‹åºï¼Œå°†ç”¨æˆ·çš„ä½™é¢ä¿å­˜åœ¨ä¸€ä¸ª uintç±»å‹çš„å˜é‡ä¸­ï¼š
mapping (address => uint) public accountBalance;
//æˆ–è€…å¯ä»¥ç”¨æ¥é€šè¿‡userId å­˜å‚¨/æŸ¥æ‰¾çš„ç”¨æˆ·å
mapping (uint => string) userIdToName;
```

æ˜ å°„æœ¬è´¨ä¸Šæ˜¯å­˜å‚¨å’ŒæŸ¥æ‰¾æ•°æ®æ‰€ç”¨çš„é”®-å€¼å¯¹ã€‚åœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼Œé”®æ˜¯ä¸€ä¸ª `address`ï¼Œå€¼æ˜¯ä¸€ä¸ª `uint`ï¼Œåœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œé”®æ˜¯ä¸€ä¸ª`uint`ï¼Œå€¼æ˜¯ä¸€ä¸ª `string`ã€‚

##### å®æˆ˜æ¼”ä¹ 

ä¸ºäº†å­˜å‚¨åƒµå°¸çš„æ‰€æœ‰æƒï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨åˆ°ä¸¤ä¸ªæ˜ å°„ï¼šä¸€ä¸ªè®°å½•åƒµå°¸æ‹¥æœ‰è€…çš„åœ°å€ï¼Œå¦ä¸€ä¸ªè®°å½•æŸåœ°å€æ‰€æ‹¥æœ‰åƒµå°¸çš„æ•°é‡ã€‚

1.åˆ›å»ºä¸€ä¸ªå«åš `zombieToOwner` çš„æ˜ å°„ã€‚å…¶é”®æ˜¯ä¸€ä¸ª`uint`ï¼ˆæˆ‘ä»¬å°†æ ¹æ®å®ƒçš„ id å­˜å‚¨å’ŒæŸ¥æ‰¾åƒµå°¸ï¼‰ï¼Œå€¼ä¸º `address`ã€‚æ˜ å°„å±æ€§ä¸º`public`ã€‚

2.åˆ›å»ºä¸€ä¸ªåä¸º `ownerZombieCount` çš„æ˜ å°„ï¼Œå…¶ä¸­é”®æ˜¯ `address`ï¼Œå€¼æ˜¯ `uint`ã€‚

``` solidity
//... other code ...
Zombie[] public zombies;
// è®°å½•åƒµå°¸æ‹¥æœ‰è€…åœ°å€
mapping(uint => address) public zombieToOwner;
// è®°å½•æŸåœ°å€æ‰€æ‹¥æœ‰çš„åƒµå°¸çš„æ•°é‡
mapping(address => uint) ownerZombieCount;
//... other code ...
```



#### ç¬¬3ç«  Msg.sender

ç°åœ¨æœ‰äº†ä¸€å¥—æ˜ å°„æ¥è®°å½•åƒµå°¸çš„æ‰€æœ‰æƒäº†ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ `_createZombie` æ–¹æ³•æ¥è¿ç”¨å®ƒä»¬ã€‚

ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬è¦ç”¨åˆ° `msg.sender`ã€‚

##### msg.sender

åœ¨ Solidity ä¸­ï¼Œæœ‰ä¸€äº›å…¨å±€å˜é‡å¯ä»¥è¢«æ‰€æœ‰å‡½æ•°è°ƒç”¨ã€‚ å…¶ä¸­ä¸€ä¸ªå°±æ˜¯ `msg.sender`ï¼Œå®ƒæŒ‡çš„æ˜¯å½“å‰è°ƒç”¨è€…ï¼ˆæˆ–æ™ºèƒ½åˆçº¦ï¼‰çš„ `address`ã€‚

> æ³¨æ„ï¼šåœ¨ Solidity ä¸­ï¼ŒåŠŸèƒ½æ‰§è¡Œå§‹ç»ˆéœ€è¦ä»å¤–éƒ¨è°ƒç”¨è€…å¼€å§‹ã€‚ ä¸€ä¸ªåˆçº¦åªä¼šåœ¨åŒºå—é“¾ä¸Šä»€ä¹ˆä¹Ÿä¸åšï¼Œé™¤éæœ‰äººè°ƒç”¨å…¶ä¸­çš„å‡½æ•°ã€‚æ‰€ä»¥ `msg.sender`æ€»æ˜¯å­˜åœ¨çš„ã€‚

ä»¥ä¸‹æ˜¯ä½¿ç”¨ `msg.sender` æ¥æ›´æ–° `mapping` çš„ä¾‹å­ï¼š

```solidity
mapping (address => uint) favoriteNumber;

function setMyNumber(uint _myNumber) public {
  // æ›´æ–°æˆ‘ä»¬çš„ `favoriteNumber` æ˜ å°„æ¥å°† `_myNumber`å­˜å‚¨åœ¨ `msg.sender`åä¸‹
  favoriteNumber[msg.sender] = _myNumber;
  // å­˜å‚¨æ•°æ®è‡³æ˜ å°„çš„æ–¹æ³•å’Œå°†æ•°æ®å­˜å‚¨åœ¨æ•°ç»„ç›¸ä¼¼
}

function whatIsMyNumber() public view returns (uint) {
  // æ‹¿åˆ°å­˜å‚¨åœ¨è°ƒç”¨è€…åœ°å€åä¸‹çš„å€¼
  // è‹¥è°ƒç”¨è€…è¿˜æ²¡è°ƒç”¨ setMyNumberï¼Œ åˆ™å€¼ä¸º `0`
  return favoriteNumber[msg.sender];
}
```

åœ¨è¿™ä¸ªå°å°çš„ä¾‹å­ä¸­ï¼Œä»»ä½•äººéƒ½å¯ä»¥è°ƒç”¨ `setMyNumber` åœ¨æˆ‘ä»¬çš„åˆçº¦ä¸­å­˜ä¸‹ä¸€ä¸ª `uint` å¹¶ä¸”ä¸ä»–ä»¬çš„åœ°å€ç›¸ç»‘å®šã€‚ ç„¶åï¼Œä»–ä»¬è°ƒç”¨ `whatIsMyNumber` å°±ä¼šè¿”å›ä»–ä»¬å­˜å‚¨çš„ `uint`ã€‚

ä½¿ç”¨ `msg.sender` å¾ˆå®‰å…¨ï¼Œå› ä¸ºå®ƒå…·æœ‰ä»¥å¤ªåŠåŒºå—é“¾çš„å®‰å…¨ä¿éšœ â€”â€” é™¤éçªƒå–ä¸ä»¥å¤ªåŠåœ°å€ç›¸å…³è”çš„ç§é’¥ï¼Œå¦åˆ™æ˜¯æ²¡æœ‰åŠæ³•ä¿®æ”¹å…¶ä»–äººçš„æ•°æ®çš„ã€‚

##### å®æˆ˜æ¼”ä¹ 

æˆ‘ä»¬æ¥ä¿®æ”¹ç¬¬1è¯¾çš„ `_createZombie` æ–¹æ³•ï¼Œå°†åƒµå°¸åˆ†é…ç»™å‡½æ•°è°ƒç”¨è€…å§ã€‚

1. é¦–å…ˆï¼Œåœ¨å¾—åˆ°æ–°çš„åƒµå°¸ `id` åï¼Œæ›´æ–° `zombieToOwner` æ˜ å°„ï¼Œåœ¨ `id` ä¸‹é¢å­˜å…¥ `msg.sender`ã€‚
2. ç„¶åï¼Œæˆ‘ä»¬ä¸ºè¿™ä¸ª `msg.sender` åä¸‹çš„ `ownerZombieCount` åŠ  1ã€‚

è·Ÿåœ¨ JavaScript ä¸­ä¸€æ ·ï¼Œ åœ¨ Solidity ä¸­ä½ ä¹Ÿå¯ä»¥ç”¨ `++` ä½¿ `uint` é€’å¢ã€‚

```solidity
uint number = 0;
number++;
// `number` ç°åœ¨æ˜¯ `1`äº†
```

ä¿®æ”¹ä¸¤è¡Œä»£ç å³å¯ã€‚

``` solidity
//... other code ...
uint id = zombies.length -1;
zombieToOwner[id] = msg.sender;
ownerZombieCount[msg.sender]++;
emit NewZombie(id, _name, _dna);
//... other code ...
```



#### ç¬¬4ç«  Require

åœ¨ç¬¬ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬æˆåŠŸè®©ç”¨æˆ·é€šè¿‡è°ƒç”¨ `createRandomZombie`å‡½æ•° å¹¶è¾“å…¥ä¸€ä¸ªåå­—æ¥åˆ›å»ºæ–°çš„åƒµå°¸ã€‚ ä½†æ˜¯ï¼Œå¦‚æœç”¨æˆ·èƒ½æŒç»­è°ƒç”¨è¿™ä¸ªå‡½æ•°æ¥åˆ›å»ºå‡ºæ— é™å¤šä¸ªåƒµå°¸åŠ å…¥ä»–ä»¬çš„å†›å›¢ï¼Œè¿™æ¸¸æˆå°±å¤ªæ²¡æ„æ€äº†ï¼

äºæ˜¯ï¼Œæˆ‘ä»¬ä½œå‡ºé™å®šï¼šæ¯ä¸ªç©å®¶åªèƒ½è°ƒç”¨ä¸€æ¬¡è¿™ä¸ªå‡½æ•°ã€‚ è¿™æ ·ä¸€æ¥ï¼Œæ–°ç©å®¶å¯ä»¥åœ¨åˆšå¼€å§‹ç©æ¸¸æˆæ—¶é€šè¿‡è°ƒç”¨å®ƒï¼Œä¸ºå…¶å†›å›¢åˆ›å»ºåˆå§‹åƒµå°¸ã€‚

æˆ‘ä»¬æ€æ ·æ‰èƒ½é™å®šæ¯ä¸ªç©å®¶åªè°ƒç”¨ä¸€æ¬¡è¿™ä¸ªå‡½æ•°å‘¢ï¼Ÿ

ç­”æ¡ˆæ˜¯ä½¿ç”¨`require`ã€‚ `require`ä½¿å¾—å‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“ä¸æ»¡è¶³æŸäº›æ¡ä»¶æ—¶æŠ›å‡ºé”™è¯¯ï¼Œå¹¶åœæ­¢æ‰§è¡Œï¼š

```solidity
function sayHiToVitalik(string _name) public returns (string) {
  // æ¯”è¾ƒ _name æ˜¯å¦ç­‰äº "Vitalik". å¦‚æœä¸æˆç«‹ï¼ŒæŠ›å‡ºå¼‚å¸¸å¹¶ç»ˆæ­¢ç¨‹åº
  // (æ•²é»‘æ¿: Solidity å¹¶ä¸æ”¯æŒåŸç”Ÿçš„å­—ç¬¦ä¸²æ¯”è¾ƒ, æˆ‘ä»¬åªèƒ½é€šè¿‡æ¯”è¾ƒ
  // ä¸¤å­—ç¬¦ä¸²çš„ keccak256 å“ˆå¸Œå€¼æ¥è¿›è¡Œåˆ¤æ–­)
  require(keccak256(_name) == keccak256("Vitalik"));
  // å¦‚æœè¿”å› true, è¿è¡Œå¦‚ä¸‹è¯­å¥
  return "Hi!";
}
```

å¦‚æœä½ è¿™æ ·è°ƒç”¨å‡½æ•° `sayHiToVitalikï¼ˆâ€œVitalikâ€ï¼‰` ,å®ƒä¼šè¿”å›â€œHiï¼â€ã€‚è€Œå¦‚æœè°ƒç”¨çš„æ—¶å€™ä½¿ç”¨äº†å…¶ä»–å‚æ•°ï¼Œå®ƒåˆ™ä¼šæŠ›å‡ºé”™è¯¯å¹¶åœæ­¢æ‰§è¡Œã€‚

å› æ­¤ï¼Œåœ¨è°ƒç”¨ä¸€ä¸ªå‡½æ•°ä¹‹å‰ï¼Œç”¨ `require` éªŒè¯å‰ç½®æ¡ä»¶æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚

##### å®æˆ˜æ¼”ä¹ 

åœ¨æˆ‘ä»¬çš„åƒµå°¸æ¸¸æˆä¸­ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›ç”¨æˆ·é€šè¿‡åå¤è°ƒç”¨ `createRandomZombie` æ¥çµ¦ä»–ä»¬çš„å†›é˜Ÿåˆ›å»ºæ— é™å¤šä¸ªåƒµå°¸ â€”â€” è¿™å°†ä½¿å¾—æ¸¸æˆéå¸¸æ— èŠã€‚

æˆ‘ä»¬ä½¿ç”¨äº† `require` æ¥ç¡®ä¿è¿™ä¸ªå‡½æ•°åªæœ‰åœ¨æ¯ä¸ªç”¨æˆ·ç¬¬ä¸€æ¬¡è°ƒç”¨å®ƒçš„æ—¶å€™æ‰§è¡Œï¼Œç”¨ä»¥åˆ›å»ºåˆå§‹åƒµå°¸ã€‚

1. åœ¨ `createRandomZombie` çš„å‰é¢æ”¾ç½® `require` è¯­å¥ã€‚ ä½¿å¾—å‡½æ•°å…ˆæ£€æŸ¥ `ownerZombieCount [msg.sender]` çš„å€¼ä¸º `0` ï¼Œä¸ç„¶å°±æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚

> æ³¨æ„ï¼šåœ¨ Solidity ä¸­ï¼Œå…³é”®è¯æ”¾ç½®çš„é¡ºåºå¹¶ä¸é‡è¦
>
> - è™½ç„¶å‚æ•°çš„ä¸¤ä¸ªä½ç½®æ˜¯ç­‰æ•ˆçš„ã€‚ ä½†æ˜¯ï¼Œç”±äºæˆ‘ä»¬çš„ç­”æ¡ˆæ£€æŸ¥å™¨æ¯”è¾ƒå‘†æ¿ï¼Œå®ƒåªèƒ½è®¤å®šå…¶ä¸­ä¸€ä¸ªä¸ºæ­£ç¡®ç­”æ¡ˆ
> - äºæ˜¯åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°±çº¦å®šæŠŠ`ownerZombieCount [msg.sender]`æ”¾å‰é¢å§

``` solidity
function createRandomZombie(string _name) public {
    // start here
    require(ownerZombieCount[msg.sender] == 0);
    uint randDna = _generateRandomDna(_name);
    _createZombie(_name, randDna);
}
```



#### ç¬¬5ç« : ç»§æ‰¿ï¼ˆInheritanceï¼‰

æˆ‘ä»¬çš„æ¸¸æˆä»£ç è¶Šæ¥è¶Šé•¿ã€‚ å½“ä»£ç è¿‡äºå†—é•¿çš„æ—¶å€™ï¼Œæœ€å¥½å°†ä»£ç å’Œé€»è¾‘åˆ†æ‹†åˆ°å¤šä¸ªä¸åŒçš„åˆçº¦ä¸­ï¼Œä»¥ä¾¿äºç®¡ç†ã€‚

æœ‰ä¸ªè®© Solidity çš„ä»£ç æ˜“äºç®¡ç†çš„åŠŸèƒ½ï¼Œå°±æ˜¯åˆçº¦ ***inheritance*** (ç»§æ‰¿)ï¼š

```solidity
contract Doge {
  function catchphrase() public returns (string) {
    return "So Wow CryptoDoge";
  }
}

contract BabyDoge is Doge {
  function anotherCatchphrase() public returns (string) {
    return "Such Moon BabyDoge";
  }
}
```

ç”±äº `BabyDoge` æ˜¯ä» `Doge` é‚£é‡Œ ***inherits*** ï¼ˆç»§æ‰¿)è¿‡æ¥çš„ã€‚ è¿™æ„å‘³ç€å½“ä½ ç¼–è¯‘å’Œéƒ¨ç½²äº† `BabyDoge`ï¼Œå®ƒå°†å¯ä»¥è®¿é—® `catchphrase()` å’Œ `anotherCatchphrase()`å’Œå…¶ä»–æˆ‘ä»¬åœ¨ `Doge` ä¸­å®šä¹‰çš„å…¶ä»–å…¬å…±å‡½æ•°ã€‚

è¿™å¯ä»¥ç”¨äºé€»è¾‘ç»§æ‰¿ï¼ˆæ¯”å¦‚è¡¨è¾¾å­ç±»çš„æ—¶å€™ï¼Œ`Cat` æ˜¯ä¸€ç§ `Animal`ï¼‰ã€‚ ä½†ä¹Ÿå¯ä»¥ç®€å•åœ°å°†ç±»ä¼¼çš„é€»è¾‘ç»„åˆåˆ°ä¸åŒçš„åˆçº¦ä¸­ä»¥ç»„ç»‡ä»£ç ã€‚

##### å®æˆ˜æ¼”ä¹ 

åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è¦ä¸ºåƒµå°¸å®ç°å„ç§åŠŸèƒ½ï¼Œè®©å®ƒå¯ä»¥â€œçŒé£Ÿâ€å’Œâ€œç¹æ®–â€ã€‚ é€šè¿‡å°†è¿™äº›è¿ç®—æ”¾åˆ°çˆ¶ç±» `ZombieFactory` ä¸­ï¼Œä½¿å¾—æ‰€æœ‰ `ZombieFactory` çš„ç»§æ‰¿è€…åˆçº¦éƒ½å¯ä»¥ä½¿ç”¨è¿™äº›æ–¹æ³•ã€‚

1. åœ¨ `ZombieFactory` ä¸‹åˆ›å»ºä¸€ä¸ªå« `ZombieFeeding` çš„åˆçº¦ï¼Œå®ƒæ˜¯ç»§æ‰¿è‡ª `ZombieFactory åˆçº¦çš„ã€‚

``` solidity
```

